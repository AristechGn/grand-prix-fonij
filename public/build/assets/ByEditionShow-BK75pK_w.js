import{r as g,j as e,B as ce,W as de,b as me}from"./app-iOletHGK.js";import{A as xe}from"./app-layout-DasG152e.js";import{D as he}from"./data-table-ofRXGMhz.js";import{B as n}from"./button-ByxYENkE.js";import{C as u,a as f,b as U,c as V,d as K}from"./card-DWV3p-y-.js";import{I as D}from"./input-tUeCua7K.js";import{B as F}from"./badge-BIC2zA02.js";import{D as ge,a as pe,b as ue,c as fe,d as je,e as be}from"./dialog-pF5g15fG.js";import{S as O,a as I,b as H,c as q,d as b}from"./select-UTFYTCV7.js";import{F as Ne}from"./index-BULwtsFH.js";import{A as we}from"./arrow-left-C6j2YPi9.js";import{C as W}from"./calendar-BRJdPF8J.js";import{D as J}from"./download-VaLzb5TN.js";import{c as ye}from"./createLucideIcon-DtpILd9e.js";import{F as ve}from"./index-cH9cEt7M.js";import{U as X}from"./users-CoapWvze.js";import{F as G}from"./filter-DSxd5Ps0.js";import{S as Ce}from"./search-DePMmnZl.js";import{X as N}from"./x-BRazAujK.js";import{T as $}from"./trash-MjeNYyrK.js";import{E as Se}from"./eye-1Hliphvk.js";import{S as _e}from"./square-pen-BtbcRCKK.js";import"./index-BoCxUqVY.js";import"./index-xTZWYnwi.js";import"./index-CeZzoMM3.js";import"./app-logo-icon-CPaor7y9.js";import"./table-C0_WwaE_.js";import"./chevron-left-DVE-foAX.js";import"./index-Bvs_RkVH.js";import"./check-D86M64AL.js";import"./trophy-BbTeHUsF.js";/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ke=[["circle",{cx:"15",cy:"19",r:"2",key:"u2pros"}],["path",{d:"M20.9 19.8A2 2 0 0 0 22 18V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2h5.1",key:"1jj40k"}],["path",{d:"M15 11v-1",key:"cntcp"}],["path",{d:"M15 17v-2",key:"1279jj"}]],Q=ye("FolderArchive",ke);function ls({edition:m,applications:x,statuses:w,categories:y,filters:t}){var T,z,B;const[i,v]=g.useState(t.search||""),[r,C]=g.useState(t.status||"all"),[l,S]=g.useState(((T=t.category)==null?void 0:T.toString())||"all"),[o,P]=g.useState(t.score_min||""),[c,E]=g.useState(t.score_max||""),[Y,j]=g.useState(!1),[d,_]=g.useState(null);console.log("Categories reçues:",y),console.log("Types des catégories:",y.map(s=>typeof s));const A=y.map(s=>typeof s=="string"?parseInt(s,10):s).filter(s=>s!=null&&!isNaN(s)&&s>0&&s<=5);console.log("Catégories nettoyées:",A);const Z=()=>{const s=new URLSearchParams;i&&s.append("search",i),r&&r!=="all"&&s.append("status",r),l&&l!=="all"&&s.append("category",l),o&&s.append("score_min",o.toString()),c&&s.append("score_max",c.toString()),t.per_page&&s.append("per_page",t.per_page.toString()),window.location.href=`${route("admin.applications.by-edition.show",m.id)}?${s.toString()}`},ee=()=>{v(""),C("all"),S("all"),P(""),E(""),window.location.href=route("admin.applications.by-edition.show",m.id)},k=s=>x.data.filter(a=>a.status===s).length,p=s=>{const a=typeof s=="string"?parseInt(s,10):s;return!a||a<=0||a>5||isNaN(a)?null:Ne.categories.find(oe=>oe.id===a)||null},M=s=>{const a=p(s),h=typeof s=="string"?parseInt(s,10):s;return a?a.title:`Catégorie ${h}`},se=[{header:"Référence",accessorKey:"application_number",cell:({row:s})=>e.jsx("a",{href:route("admin.applications.show",s.original.id),className:"font-mono text-blue-600 hover:underline",children:s.getValue("application_number")})},{header:"Candidat",accessorFn:s=>`${s.first_name} ${s.last_name}`},{header:"Projet",accessorKey:"project_name"},{header:"Catégorie",accessorKey:"category",cell:({row:s})=>{const a=p(s.original.category);return a?e.jsxs("div",{className:"max-w-[200px]",children:[e.jsx("div",{className:"font-medium text-sm text-gray-900 truncate",title:a.title,children:a.title}),e.jsx("div",{className:"text-xs text-gray-500 truncate",title:a.description,children:a.description})]}):e.jsx("div",{className:"max-w-[200px]",children:e.jsxs("span",{className:"text-sm text-gray-500 font-medium",children:["Catégorie ",s.original.category]})})}},{header:"Statut",accessorKey:"status",cell:({row:s})=>e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${ae(s.original.status)}`,children:w[s.original.status]})},{header:"Score",accessorKey:"score",cell:({row:s})=>e.jsx("span",{className:"font-mono",children:s.original.score?`${s.original.score}/100`:"-"})},{header:"Date",accessorKey:"submitted_at",cell:({row:s})=>new Date(s.original.submitted_at).toLocaleDateString("fr-FR")},{header:"Actions",cell:({row:s})=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(n,{variant:"outline",size:"sm",onClick:()=>window.location.href=route("admin.applications.show",s.original.id),className:"hover:bg-blue-50 hover:border-blue-300 transition-colors",title:"Voir les détails",children:e.jsx(Se,{className:"h-4 w-4 text-blue-600"})}),e.jsx(n,{variant:"outline",size:"sm",onClick:()=>window.location.href=route("admin.applications.edit",s.original.id),className:"hover:bg-green-50 hover:border-green-300 transition-colors",title:"Modifier",children:e.jsx(_e,{className:"h-4 w-4 text-green-600"})}),e.jsx(n,{variant:"outline",size:"sm",onClick:()=>te(s.original),className:"hover:bg-red-50 hover:border-red-300 transition-colors",title:"Supprimer",children:e.jsx($,{className:"h-4 w-4 text-red-600"})})]})}],ae=s=>({pending:"bg-yellow-100 text-yellow-800",validated:"bg-green-100 text-green-800",rejected:"bg-red-100 text-red-800",selected:"bg-blue-100 text-blue-800",finalist:"bg-purple-100 text-purple-800",winner:"bg-indigo-100 text-indigo-800"})[s]||"bg-gray-100 text-gray-800",R=()=>{const s=new URLSearchParams;s.append("edition_id",m.id.toString()),i&&s.append("search",i),r&&r!=="all"&&s.append("status",r),l&&l!=="all"&&s.append("category",l),o&&s.append("score_min",o.toString()),c&&s.append("score_max",c.toString()),window.open(`${route("admin.applications.export")}?${s.toString()}`,"_blank")},L=()=>{const s=new URLSearchParams;s.append("edition_id",m.id.toString()),i&&s.append("search",i),r&&r!=="all"&&s.append("status",r),l&&l!=="all"&&s.append("category",l),o&&s.append("score_min",o.toString()),c&&s.append("score_max",c.toString()),window.location.href=`${route("admin.applications.export-folders")}?${s.toString()}`},te=s=>{_(s),j(!0)},re=()=>{d&&me.delete(route("admin.applications.destroy",d.id),{onSuccess:()=>{j(!1),_(null)},onError:s=>{console.error("Erreur lors de la suppression:",s)}})},le=()=>{j(!1),_(null)},ne=s=>{const a=new URLSearchParams;i&&a.append("search",i),r&&r!=="all"&&a.append("status",r),l&&l!=="all"&&a.append("category",l),o&&a.append("score_min",o.toString()),c&&a.append("score_max",c.toString()),t.per_page&&a.append("per_page",t.per_page.toString()),a.append("page",s.toString()),window.location.href=`${route("admin.applications.by-edition.show",m.id)}?${a.toString()}`},ie=s=>{const a=new URLSearchParams;i&&a.append("search",i),r&&r!=="all"&&a.append("status",r),l&&l!=="all"&&a.append("category",l),o&&a.append("score_min",o.toString()),c&&a.append("score_max",c.toString()),a.append("per_page",s.toString()),window.location.href=`${route("admin.applications.by-edition.show",m.id)}?${a.toString()}`};return e.jsxs(xe,{children:[e.jsx(ce,{title:`Candidatures - ${m.name}`}),e.jsx("div",{className:"py-8 overflow-x-hidden",children:e.jsxs("div",{className:"max-w-5xl mx-auto px-4 sm:px-6 lg:px-8 w-full space-y-6 overflow-x-hidden",children:[e.jsx("div",{className:"mb-6 bg-gradient-to-r from-blue-50 to-blue-100 rounded-lg p-6 shadow-md",children:e.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center lg:justify-between gap-4",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(de,{href:route("admin.applications.by-edition"),children:e.jsxs(n,{variant:"outline",size:"sm",className:"bg-white hover:bg-gray-50 transition-colors",children:[e.jsx(we,{className:"h-4 w-4 mr-2 text-blue-600"}),"Retour"]})}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsxs("h1",{className:"text-2xl sm:text-3xl lg:text-4xl font-extrabold text-gray-900 flex items-center gap-2 sm:gap-4",children:[e.jsx(W,{className:"h-8 w-8 sm:h-10 sm:w-10 text-blue-600 bg-white rounded-full p-2 shadow-md flex-shrink-0"}),e.jsx("span",{className:"truncate",children:m.name})]}),e.jsxs("p",{className:"text-gray-600 mt-2 text-sm sm:text-lg break-words",children:["Édition ",m.year," - ",x.total," candidature",x.total>1?"s":""]})]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 w-full lg:w-auto",children:[e.jsxs(n,{onClick:R,className:"bg-green-500 hover:bg-green-600 text-white transition-colors shadow-md",children:[e.jsx(J,{className:"h-5 w-5 mr-2"}),"Exporter Excel"]}),e.jsxs(n,{onClick:L,className:"bg-blue-500 hover:bg-blue-600 text-white transition-colors shadow-md",children:[e.jsx(Q,{className:"h-5 w-5 mr-2"}),"Exporter Dossiers"]})]})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-6",children:[e.jsx(u,{className:"hover:shadow-lg transition-shadow",children:e.jsx(f,{className:"p-6 bg-gradient-to-br from-blue-50 to-blue-100 rounded-lg",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"h-14 w-14 rounded-full bg-blue-200 flex items-center justify-center mr-5 shadow-md",children:e.jsx(ve,{className:"h-7 w-7 text-blue-700"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-700 font-semibold",children:"Total candidatures"}),e.jsx("p",{className:"text-3xl font-bold text-blue-900",children:x.total})]})]})})}),e.jsx(u,{className:"hover:shadow-lg transition-shadow",children:e.jsx(f,{className:"p-6 bg-gradient-to-br from-green-50 to-green-100 rounded-lg",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"h-14 w-14 rounded-full bg-green-200 flex items-center justify-center mr-5 shadow-md",children:e.jsx(X,{className:"h-7 w-7 text-green-700"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-700 font-semibold",children:"Validées"}),e.jsx("p",{className:"text-3xl font-bold text-green-900",children:k("validated")})]})]})})}),e.jsx(u,{className:"hover:shadow-lg transition-shadow",children:e.jsx(f,{className:"p-6 bg-gradient-to-br from-yellow-50 to-yellow-100 rounded-lg",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"h-14 w-14 rounded-full bg-yellow-200 flex items-center justify-center mr-5 shadow-md",children:e.jsx(W,{className:"h-7 w-7 text-yellow-700"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-700 font-semibold",children:"En attente"}),e.jsx("p",{className:"text-3xl font-bold text-yellow-900",children:k("pending")})]})]})})}),e.jsx(u,{className:"hover:shadow-lg transition-shadow",children:e.jsx(f,{className:"p-6 bg-gradient-to-br from-purple-50 to-purple-100 rounded-lg",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"h-14 w-14 rounded-full bg-purple-200 flex items-center justify-center mr-5 shadow-md",children:e.jsx(X,{className:"h-7 w-7 text-purple-700"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-700 font-semibold",children:"Finalistes"}),e.jsx("p",{className:"text-3xl font-bold text-purple-900",children:k("finalist")})]})]})})})]}),e.jsxs(u,{className:"mb-6 bg-gradient-to-br from-gray-50 to-gray-100 shadow-lg",children:[e.jsxs(U,{className:"bg-white/50 backdrop-blur-sm rounded-t-lg border-b border-gray-200",children:[e.jsxs(V,{className:"flex items-center gap-3 text-xl font-bold text-gray-800",children:[e.jsx(G,{className:"h-6 w-6 text-blue-600"}),"Filtres de recherche"]}),e.jsx(K,{className:"text-gray-600",children:"Affinez votre recherche avec des filtres précis"})]}),e.jsxs(f,{className:"p-6 space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"md:col-span-2 min-w-0",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Recherche"}),e.jsxs("div",{className:"relative",children:[e.jsx(Ce,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-4 w-4"}),e.jsx(D,{placeholder:"Nom, projet, email...",className:"pl-10 bg-white border-gray-300 focus:ring-2 focus:ring-blue-500 transition-all w-full",value:i,onChange:s=>v(s.target.value)})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Statut"}),e.jsxs(O,{value:r,onValueChange:C,children:[e.jsx(I,{className:"bg-white border-gray-300 focus:ring-2 focus:ring-blue-500 transition-all",children:e.jsx(H,{placeholder:"Tous les statuts"})}),e.jsxs(q,{className:"bg-white shadow-lg rounded-lg",children:[e.jsx(b,{value:"all",className:"hover:bg-gray-100 transition-colors",children:"Tous les statuts"}),Object.entries(w).map(([s,a])=>e.jsx(b,{value:s,className:"hover:bg-gray-100 transition-colors",children:a},s))]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Catégorie"}),e.jsxs(O,{value:l,onValueChange:S,children:[e.jsx(I,{className:"bg-white border-gray-300 focus:ring-2 focus:ring-blue-500 transition-all",children:e.jsx(H,{placeholder:"Toutes les catégories"})}),e.jsxs(q,{className:"bg-white shadow-lg rounded-lg",children:[e.jsx(b,{value:"all",className:"hover:bg-gray-100 transition-colors",children:"Toutes les catégories"}),A.map(s=>{const a=Number(s),h=p(a);return e.jsx(b,{value:a.toString(),className:"hover:bg-gray-100 transition-colors",children:e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"font-medium",children:(h==null?void 0:h.title)||`Catégorie ${a}`}),h&&e.jsx("span",{className:"text-xs text-gray-500 truncate max-w-[200px]",children:h.description})]})},a)})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Score"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(D,{type:"number",placeholder:"Min",min:"0",max:"100",value:o,onChange:s=>P(s.target.value),className:"w-20 bg-white border-gray-300 focus:ring-2 focus:ring-blue-500 transition-all"}),e.jsx("span",{className:"flex items-center text-gray-500",children:"-"}),e.jsx(D,{type:"number",placeholder:"Max",min:"0",max:"100",value:c,onChange:s=>E(s.target.value),className:"w-20 bg-white border-gray-300 focus:ring-2 focus:ring-blue-500 transition-all"})]})]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4 mt-4",children:[e.jsxs("div",{className:"flex gap-2 flex-wrap",children:[e.jsxs(n,{onClick:Z,className:"bg-blue-600 hover:bg-blue-700 text-white transition-colors shadow-md",children:[e.jsx(G,{className:"h-4 w-4 mr-2"}),"Appliquer les filtres"]}),e.jsxs(n,{variant:"outline",onClick:ee,className:"border-gray-300 hover:bg-gray-100 transition-colors",children:[e.jsx(N,{className:"h-4 w-4 mr-2"}),"Réinitialiser"]})]}),e.jsxs("div",{className:"flex gap-2 flex-wrap min-w-0",children:[t.search&&e.jsxs(F,{variant:"secondary",className:"flex items-center gap-1 bg-blue-100 text-blue-800 hover:bg-blue-200 transition-colors max-w-full",children:[e.jsxs("span",{className:"truncate",children:["Recherche: ",t.search]}),e.jsx(N,{className:"h-3 w-3 cursor-pointer text-blue-600 hover:text-blue-800 flex-shrink-0",onClick:()=>v("")})]}),t.status&&e.jsxs(F,{variant:"secondary",className:"flex items-center gap-1 bg-green-100 text-green-800 hover:bg-green-200 transition-colors max-w-full",children:[e.jsxs("span",{className:"truncate",children:["Statut: ",w[t.status]]}),e.jsx(N,{className:"h-3 w-3 cursor-pointer text-green-600 hover:text-green-800 flex-shrink-0",onClick:()=>C("all")})]}),t.category&&e.jsxs(F,{variant:"secondary",className:"flex items-center gap-1 bg-purple-100 text-purple-800 hover:bg-purple-200 transition-colors max-w-full",children:[e.jsxs("div",{className:"flex flex-col min-w-0",children:[e.jsxs("span",{className:"font-medium truncate",children:["Catégorie: ",M(t.category)]}),p(t.category)&&e.jsx("span",{className:"text-xs opacity-75 truncate max-w-[150px]",children:(z=p(t.category))==null?void 0:z.description})]}),e.jsx(N,{className:"h-3 w-3 cursor-pointer text-purple-600 hover:text-purple-800 flex-shrink-0",onClick:()=>S("all")})]})]})]})]})]}),e.jsxs(u,{children:[e.jsx(U,{children:e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsxs(V,{className:"break-words",children:["Candidatures de l'édition ",m.name,t.category&&e.jsxs("span",{className:"ml-2 text-sm font-normal text-gray-600",children:["- Catégorie: ",M(t.category)]})]}),e.jsxs(K,{className:"break-words",children:["Liste des candidatures soumises pour cette édition",t.category&&e.jsx("span",{className:"block text-xs text-gray-500 mt-1 break-words",children:(B=p(t.category))==null?void 0:B.description})]})]}),e.jsxs("div",{className:"flex gap-2 flex-shrink-0",children:[e.jsxs(n,{onClick:R,variant:"outline",size:"sm",children:[e.jsx(J,{className:"h-4 w-4 mr-2"}),"Excel"]}),e.jsxs(n,{onClick:L,variant:"outline",size:"sm",children:[e.jsx(Q,{className:"h-4 w-4 mr-2"}),"Dossiers"]})]})]})}),e.jsx(f,{children:e.jsx("div",{className:"overflow-x-auto w-full",children:e.jsx(he,{columns:se,data:x.data,pagination:{pageIndex:x.current_page-1,pageSize:x.per_page,pageCount:x.last_page,total:x.total},onPageChange:ne,onItemsPerPageChange:ie,itemsPerPageOptions:[10,25,50,100]})})})]})]})}),e.jsx(ge,{open:Y,onOpenChange:j,children:e.jsxs(pe,{className:"max-w-md",children:[e.jsxs(ue,{children:[e.jsxs(fe,{className:"text-red-600 flex items-center gap-2",children:[e.jsx($,{className:"h-5 w-5"}),"Confirmer la suppression"]}),e.jsxs(je,{className:"text-gray-600",children:["Êtes-vous sûr de vouloir supprimer la candidature de"," ",e.jsxs("span",{className:"font-semibold text-gray-900",children:[d==null?void 0:d.first_name," ",d==null?void 0:d.last_name]})," ","pour le projet"," ",e.jsxs("span",{className:"font-semibold text-gray-900",children:['"',d==null?void 0:d.project_name,'"']}),"?",e.jsx("br",{}),e.jsx("br",{}),e.jsx("span",{className:"text-red-600 font-medium",children:"Cette action est irréversible et supprimera définitivement tous les fichiers associés."})]})]}),e.jsxs(be,{className:"gap-2",children:[e.jsx(n,{variant:"outline",onClick:le,className:"border-gray-300 hover:bg-gray-100 transition-colors",children:"Annuler"}),e.jsxs(n,{onClick:re,className:"bg-red-600 hover:bg-red-700 text-white transition-colors",children:[e.jsx($,{className:"h-4 w-4 mr-2"}),"Supprimer définitivement"]})]})]})})]})}export{ls as default};
