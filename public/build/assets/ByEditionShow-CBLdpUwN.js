import{r as h,j as e,B as ie,W as oe,b as ce}from"./app-BzYMqYyu.js";import{A as de}from"./app-layout-ZuaU15Zf.js";import{D as me}from"./data-table-hq6oiTvy.js";import{B as i}from"./button-Xhgy9Aip.js";import{C as u,d as j,a as z,b as K,c as O}from"./card-goTVSTKG.js";import{I as D}from"./input-DHkJ-nee.js";import{B as $}from"./badge-RecYBSBP.js";import{D as xe,a as ge,b as he,c as pe,d as ue,e as je}from"./dialog-7gGEdp32.js";import{S as U,a as V,b as I,c as q,d as f}from"./select-C9k0K1iT.js";import{F as be}from"./index-DbF6Y4aE.js";import{A as fe}from"./arrow-left-RB4FT4Ws.js";import{C as H}from"./calendar-DfF61T53.js";import{D as W}from"./download-BUwrw3lo.js";import{F as Ne}from"./index-CZBcc_4f.js";import{U as J}from"./users-CmzQaYbM.js";import{F as X}from"./filter-DGaNS56_.js";import{S as ye}from"./search-B3rBZLc8.js";import{X as N}from"./x-CjcniJTF.js";import{T as F}from"./trash-GtE1me3H.js";import{E as we}from"./eye-DuQs2xtn.js";import{S as ve}from"./square-pen-BOLAcU-H.js";import"./index-uw1hpYez.js";import"./index-BCsrd3KU.js";import"./index-D9H5YUaI.js";import"./createLucideIcon-ePX0JgK8.js";import"./app-logo-icon-DEg5AZqv.js";import"./table-OLrBn9Gt.js";import"./chevron-left-CzX1gKK5.js";import"./index-B3yLtKMH.js";import"./check-CCkaZJAm.js";import"./trophy-D5msJHjD.js";function ss({edition:o,applications:c,statuses:y,categories:w,filters:t}){var M,L,B;const[d,v]=h.useState(t.search||""),[r,C]=h.useState(t.status||"all"),[l,S]=h.useState(((M=t.category)==null?void 0:M.toString())||"all"),[m,P]=h.useState(t.score_min||""),[x,E]=h.useState(t.score_max||""),[G,b]=h.useState(!1),[n,_]=h.useState(null);console.log("Categories reçues:",w),console.log("Types des catégories:",w.map(s=>typeof s));const R=w.map(s=>typeof s=="string"?parseInt(s,10):s).filter(s=>s!=null&&!isNaN(s)&&s>0&&s<=5);console.log("Catégories nettoyées:",R);const Q=()=>{const s=new URLSearchParams;d&&s.append("search",d),r&&r!=="all"&&s.append("status",r),l&&l!=="all"&&s.append("category",l),m&&s.append("score_min",m.toString()),x&&s.append("score_max",x.toString()),t.per_page&&s.append("per_page",t.per_page.toString()),window.location.href=`${route("admin.applications.by-edition.show",o.id)}?${s.toString()}`},Y=()=>{v(""),C("all"),S("all"),P(""),E(""),window.location.href=route("admin.applications.by-edition.show",o.id)},k=s=>c.data.filter(a=>a.status===s).length,p=s=>{const a=typeof s=="string"?parseInt(s,10):s;return!a||a<=0||a>5||isNaN(a)?null:be.categories.find(ne=>ne.id===a)||null},T=s=>{const a=p(s),g=typeof s=="string"?parseInt(s,10):s;return a?a.title:`Catégorie ${g}`},Z=[{header:"Référence",accessorKey:"application_number"},{header:"Candidat",accessorFn:s=>`${s.first_name} ${s.last_name}`},{header:"Projet",accessorKey:"project_name"},{header:"Catégorie",accessorKey:"category",cell:({row:s})=>{const a=p(s.original.category);return a?e.jsxs("div",{className:"max-w-[200px]",children:[e.jsx("div",{className:"font-medium text-sm text-gray-900 truncate",title:a.title,children:a.title}),e.jsx("div",{className:"text-xs text-gray-500 truncate",title:a.description,children:a.description})]}):e.jsx("div",{className:"max-w-[200px]",children:e.jsxs("span",{className:"text-sm text-gray-500 font-medium",children:["Catégorie ",s.original.category]})})}},{header:"Statut",accessorKey:"status",cell:({row:s})=>e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${ee(s.original.status)}`,children:y[s.original.status]})},{header:"Score",accessorKey:"score",cell:({row:s})=>e.jsx("span",{className:"font-mono",children:s.original.score?`${s.original.score}/100`:"-"})},{header:"Date",accessorKey:"submitted_at",cell:({row:s})=>new Date(s.original.submitted_at).toLocaleDateString("fr-FR")},{header:"Actions",cell:({row:s})=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(i,{variant:"outline",size:"sm",onClick:()=>window.location.href=route("admin.applications.show",s.original.id),className:"hover:bg-blue-50 hover:border-blue-300 transition-colors",title:"Voir les détails",children:e.jsx(we,{className:"h-4 w-4 text-blue-600"})}),e.jsx(i,{variant:"outline",size:"sm",onClick:()=>window.location.href=route("admin.applications.edit",s.original.id),className:"hover:bg-green-50 hover:border-green-300 transition-colors",title:"Modifier",children:e.jsx(ve,{className:"h-4 w-4 text-green-600"})}),e.jsx(i,{variant:"outline",size:"sm",onClick:()=>se(s.original),className:"hover:bg-red-50 hover:border-red-300 transition-colors",title:"Supprimer",children:e.jsx(F,{className:"h-4 w-4 text-red-600"})})]})}],ee=s=>({pending:"bg-yellow-100 text-yellow-800",validated:"bg-green-100 text-green-800",rejected:"bg-red-100 text-red-800",selected:"bg-blue-100 text-blue-800",finalist:"bg-purple-100 text-purple-800",winner:"bg-indigo-100 text-indigo-800"})[s]||"bg-gray-100 text-gray-800",A=()=>{const s=new URLSearchParams;s.append("edition_id",o.id.toString()),d&&s.append("search",d),r&&r!=="all"&&s.append("status",r),l&&l!=="all"&&s.append("category",l),m&&s.append("score_min",m.toString()),x&&s.append("score_max",x.toString()),window.open(`${route("admin.applications.export")}?${s.toString()}`,"_blank")},se=s=>{_(s),b(!0)},ae=()=>{n&&ce.delete(route("admin.applications.destroy",n.id),{onSuccess:()=>{b(!1),_(null)},onError:s=>{console.error("Erreur lors de la suppression:",s)}})},te=()=>{b(!1),_(null)},re=s=>{const a=new URLSearchParams;d&&a.append("search",d),r&&r!=="all"&&a.append("status",r),l&&l!=="all"&&a.append("category",l),m&&a.append("score_min",m.toString()),x&&a.append("score_max",x.toString()),t.per_page&&a.append("per_page",t.per_page.toString()),a.append("page",s.toString()),window.location.href=`${route("admin.applications.by-edition.show",o.id)}?${a.toString()}`},le=s=>{const a=new URLSearchParams;d&&a.append("search",d),r&&r!=="all"&&a.append("status",r),l&&l!=="all"&&a.append("category",l),m&&a.append("score_min",m.toString()),x&&a.append("score_max",x.toString()),a.append("per_page",s.toString()),window.location.href=`${route("admin.applications.by-edition.show",o.id)}?${a.toString()}`};return e.jsxs(de,{children:[e.jsx(ie,{title:`Candidatures - ${o.name}`}),e.jsx("div",{className:"py-8",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[e.jsx("div",{className:"mb-6 bg-gradient-to-r from-blue-50 to-blue-100 rounded-lg p-6 shadow-md",children:e.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center lg:justify-between gap-4",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(oe,{href:route("admin.applications.by-edition"),children:e.jsxs(i,{variant:"outline",size:"sm",className:"bg-white hover:bg-gray-50 transition-colors",children:[e.jsx(fe,{className:"h-4 w-4 mr-2 text-blue-600"}),"Retour"]})}),e.jsxs("div",{children:[e.jsxs("h1",{className:"text-4xl font-extrabold text-gray-900 flex items-center gap-4",children:[e.jsx(H,{className:"h-10 w-10 text-blue-600 bg-white rounded-full p-2 shadow-md"}),o.name]}),e.jsxs("p",{className:"text-gray-600 mt-2 text-lg",children:["Édition ",o.year," - ",c.total," candidature",c.total>1?"s":""]})]})]}),e.jsxs(i,{onClick:A,className:"bg-green-500 hover:bg-green-600 text-white transition-colors shadow-md w-full lg:w-auto",children:[e.jsx(W,{className:"h-5 w-5 mr-2"}),"Exporter les candidatures"]})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-6",children:[e.jsx(u,{className:"hover:shadow-lg transition-shadow",children:e.jsx(j,{className:"p-6 bg-gradient-to-br from-blue-50 to-blue-100 rounded-lg",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"h-14 w-14 rounded-full bg-blue-200 flex items-center justify-center mr-5 shadow-md",children:e.jsx(Ne,{className:"h-7 w-7 text-blue-700"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-700 font-semibold",children:"Total candidatures"}),e.jsx("p",{className:"text-3xl font-bold text-blue-900",children:c.total})]})]})})}),e.jsx(u,{className:"hover:shadow-lg transition-shadow",children:e.jsx(j,{className:"p-6 bg-gradient-to-br from-green-50 to-green-100 rounded-lg",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"h-14 w-14 rounded-full bg-green-200 flex items-center justify-center mr-5 shadow-md",children:e.jsx(J,{className:"h-7 w-7 text-green-700"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-700 font-semibold",children:"Validées"}),e.jsx("p",{className:"text-3xl font-bold text-green-900",children:k("validated")})]})]})})}),e.jsx(u,{className:"hover:shadow-lg transition-shadow",children:e.jsx(j,{className:"p-6 bg-gradient-to-br from-yellow-50 to-yellow-100 rounded-lg",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"h-14 w-14 rounded-full bg-yellow-200 flex items-center justify-center mr-5 shadow-md",children:e.jsx(H,{className:"h-7 w-7 text-yellow-700"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-700 font-semibold",children:"En attente"}),e.jsx("p",{className:"text-3xl font-bold text-yellow-900",children:k("pending")})]})]})})}),e.jsx(u,{className:"hover:shadow-lg transition-shadow",children:e.jsx(j,{className:"p-6 bg-gradient-to-br from-purple-50 to-purple-100 rounded-lg",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"h-14 w-14 rounded-full bg-purple-200 flex items-center justify-center mr-5 shadow-md",children:e.jsx(J,{className:"h-7 w-7 text-purple-700"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-700 font-semibold",children:"Finalistes"}),e.jsx("p",{className:"text-3xl font-bold text-purple-900",children:k("finalist")})]})]})})})]}),e.jsxs(u,{className:"mb-6 bg-gradient-to-br from-gray-50 to-gray-100 shadow-lg",children:[e.jsxs(z,{className:"bg-white/50 backdrop-blur-sm rounded-t-lg border-b border-gray-200",children:[e.jsxs(K,{className:"flex items-center gap-3 text-xl font-bold text-gray-800",children:[e.jsx(X,{className:"h-6 w-6 text-blue-600"}),"Filtres de recherche"]}),e.jsx(O,{className:"text-gray-600",children:"Affinez votre recherche avec des filtres précis"})]}),e.jsxs(j,{className:"p-6 space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Recherche"}),e.jsxs("div",{className:"relative",children:[e.jsx(ye,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-4 w-4"}),e.jsx(D,{placeholder:"Nom, projet, email...",className:"pl-10 bg-white border-gray-300 focus:ring-2 focus:ring-blue-500 transition-all",value:d,onChange:s=>v(s.target.value)})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Statut"}),e.jsxs(U,{value:r,onValueChange:C,children:[e.jsx(V,{className:"bg-white border-gray-300 focus:ring-2 focus:ring-blue-500 transition-all",children:e.jsx(I,{placeholder:"Tous les statuts"})}),e.jsxs(q,{className:"bg-white shadow-lg rounded-lg",children:[e.jsx(f,{value:"all",className:"hover:bg-gray-100 transition-colors",children:"Tous les statuts"}),Object.entries(y).map(([s,a])=>e.jsx(f,{value:s,className:"hover:bg-gray-100 transition-colors",children:a},s))]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Catégorie"}),e.jsxs(U,{value:l,onValueChange:S,children:[e.jsx(V,{className:"bg-white border-gray-300 focus:ring-2 focus:ring-blue-500 transition-all",children:e.jsx(I,{placeholder:"Toutes les catégories"})}),e.jsxs(q,{className:"bg-white shadow-lg rounded-lg",children:[e.jsx(f,{value:"all",className:"hover:bg-gray-100 transition-colors",children:"Toutes les catégories"}),R.map(s=>{const a=Number(s),g=p(a);return e.jsx(f,{value:a.toString(),className:"hover:bg-gray-100 transition-colors",children:e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"font-medium",children:(g==null?void 0:g.title)||`Catégorie ${a}`}),g&&e.jsx("span",{className:"text-xs text-gray-500 truncate max-w-[200px]",children:g.description})]})},a)})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Score"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(D,{type:"number",placeholder:"Min",min:"0",max:"100",value:m,onChange:s=>P(s.target.value),className:"w-20 bg-white border-gray-300 focus:ring-2 focus:ring-blue-500 transition-all"}),e.jsx("span",{className:"flex items-center text-gray-500",children:"-"}),e.jsx(D,{type:"number",placeholder:"Max",min:"0",max:"100",value:x,onChange:s=>E(s.target.value),className:"w-20 bg-white border-gray-300 focus:ring-2 focus:ring-blue-500 transition-all"})]})]})]}),e.jsxs("div",{className:"flex justify-between items-center mt-4",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(i,{onClick:Q,className:"bg-blue-600 hover:bg-blue-700 text-white transition-colors shadow-md",children:[e.jsx(X,{className:"h-4 w-4 mr-2"}),"Appliquer les filtres"]}),e.jsxs(i,{variant:"outline",onClick:Y,className:"border-gray-300 hover:bg-gray-100 transition-colors",children:[e.jsx(N,{className:"h-4 w-4 mr-2"}),"Réinitialiser"]})]}),e.jsxs("div",{className:"flex gap-2",children:[t.search&&e.jsxs($,{variant:"secondary",className:"flex items-center gap-1 bg-blue-100 text-blue-800 hover:bg-blue-200 transition-colors",children:["Recherche: ",t.search,e.jsx(N,{className:"h-3 w-3 cursor-pointer text-blue-600 hover:text-blue-800",onClick:()=>v("")})]}),t.status&&e.jsxs($,{variant:"secondary",className:"flex items-center gap-1 bg-green-100 text-green-800 hover:bg-green-200 transition-colors",children:["Statut: ",y[t.status],e.jsx(N,{className:"h-3 w-3 cursor-pointer text-green-600 hover:text-green-800",onClick:()=>C("all")})]}),t.category&&e.jsxs($,{variant:"secondary",className:"flex items-center gap-1 bg-purple-100 text-purple-800 hover:bg-purple-200 transition-colors",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsxs("span",{className:"font-medium",children:["Catégorie: ",T(t.category)]}),p(t.category)&&e.jsx("span",{className:"text-xs opacity-75 truncate max-w-[150px]",children:(L=p(t.category))==null?void 0:L.description})]}),e.jsx(N,{className:"h-3 w-3 cursor-pointer text-purple-600 hover:text-purple-800",onClick:()=>S("all")})]})]})]})]})]}),e.jsxs(u,{children:[e.jsx(z,{children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsxs(K,{children:["Candidatures de l'édition ",o.name,t.category&&e.jsxs("span",{className:"ml-2 text-sm font-normal text-gray-600",children:["- Catégorie: ",T(t.category)]})]}),e.jsxs(O,{children:["Liste des candidatures soumises pour cette édition",t.category&&e.jsx("span",{className:"block text-xs text-gray-500 mt-1",children:(B=p(t.category))==null?void 0:B.description})]})]}),e.jsxs(i,{onClick:A,children:[e.jsx(W,{className:"h-4 w-4 mr-2"}),"Exporter"]})]})}),e.jsx(j,{children:e.jsx(me,{columns:Z,data:c.data,pagination:{pageIndex:c.current_page-1,pageSize:c.per_page,pageCount:c.last_page,total:c.total},onPageChange:re,onItemsPerPageChange:le,itemsPerPageOptions:[10,25,50,100]})})]})]})}),e.jsx(xe,{open:G,onOpenChange:b,children:e.jsxs(ge,{className:"max-w-md",children:[e.jsxs(he,{children:[e.jsxs(pe,{className:"text-red-600 flex items-center gap-2",children:[e.jsx(F,{className:"h-5 w-5"}),"Confirmer la suppression"]}),e.jsxs(ue,{className:"text-gray-600",children:["Êtes-vous sûr de vouloir supprimer la candidature de"," ",e.jsxs("span",{className:"font-semibold text-gray-900",children:[n==null?void 0:n.first_name," ",n==null?void 0:n.last_name]})," ","pour le projet"," ",e.jsxs("span",{className:"font-semibold text-gray-900",children:['"',n==null?void 0:n.project_name,'"']}),"?",e.jsx("br",{}),e.jsx("br",{}),e.jsx("span",{className:"text-red-600 font-medium",children:"Cette action est irréversible et supprimera définitivement tous les fichiers associés."})]})]}),e.jsxs(je,{className:"gap-2",children:[e.jsx(i,{variant:"outline",onClick:te,className:"border-gray-300 hover:bg-gray-100 transition-colors",children:"Annuler"}),e.jsxs(i,{onClick:ae,className:"bg-red-600 hover:bg-red-700 text-white transition-colors",children:[e.jsx(F,{className:"h-4 w-4 mr-2"}),"Supprimer définitivement"]})]})]})})]})}export{ss as default};
