import{r as c,j as e,B as le,W as ie,b as ne}from"./app-xeWqMw02.js";import{A as oe}from"./app-layout-CiPMfGGB.js";import{D as ce}from"./data-table-BcHYveOJ.js";import{B as i}from"./button-DpcfQQuF.js";import{C as m,d as x,a as L,b as O,c as V}from"./card-DenU_v66.js";import{I as _}from"./input-Bero_M9q.js";import{B as F}from"./badge-CXa4a3ZD.js";import{D as de,a as me,b as xe,c as he,d as ge,e as ue}from"./dialog-Df-z5Ari.js";import{S as P,a as U,b as q,c as H,d as p}from"./select-Ahe9BGAa.js";import{F as pe}from"./index-DMR75fBX.js";import{A as je}from"./arrow-left-Ci9uW2AJ.js";import{C as I}from"./calendar-0dO8aJrl.js";import{D as W}from"./download-DgdrDmEB.js";import{F as be}from"./index-C7PuUbtv.js";import{U as J}from"./users-DJmzVTbx.js";import{F as X}from"./filter-Bx8opn2g.js";import{S as fe}from"./search-_YFBuYdd.js";import{X as j}from"./x-CZfyUtcJ.js";import{T as E}from"./trash-Bz9t-UNb.js";import{E as Ne}from"./eye-CCp2AMfD.js";import{S as ye}from"./square-pen-C57wmEsp.js";import"./index-CSIUTIcG.js";import"./index-DEpnV4UD.js";import"./index-vqPFnmh1.js";import"./createLucideIcon-CpV1pLD_.js";import"./app-logo-icon-D5eZye9z.js";import"./clock-B-ZYNtz_.js";import"./circle-check-big-DW4eD9wy.js";import"./table-DDltfCKg.js";import"./index-Qp6EDw3b.js";import"./check-DK7SmTp7.js";import"./trophy-CW32_QOw.js";function es({edition:o,applications:l,statuses:b,categories:f,filters:t}){var B,z,K;const[N,y]=c.useState(t.search||""),[h,v]=c.useState(t.status||"all"),[g,w]=c.useState(((B=t.category)==null?void 0:B.toString())||"all"),[C,T]=c.useState(t.score_min||""),[S,M]=c.useState(t.score_max||""),[G,u]=c.useState(!1),[r,k]=c.useState(null);console.log("Categories reçues:",f),console.log("Types des catégories:",f.map(s=>typeof s));const A=f.map(s=>typeof s=="string"?parseInt(s,10):s).filter(s=>s!=null&&!isNaN(s)&&s>0&&s<=5);console.log("Catégories nettoyées:",A);const Q=()=>{const s=new URLSearchParams;N&&s.append("search",N),h&&h!=="all"&&s.append("status",h),g&&g!=="all"&&s.append("category",g),C&&s.append("score_min",C.toString()),S&&s.append("score_max",S.toString()),window.location.href=`${route("admin.applications.by-edition.show",o.id)}?${s.toString()}`},Y=()=>{y(""),v("all"),w("all"),T(""),M(""),window.location.href=route("admin.applications.by-edition.show",o.id)},D=s=>l.data.filter(a=>a.status===s).length,d=s=>{const a=typeof s=="string"?parseInt(s,10):s;return!a||a<=0||a>5||isNaN(a)?null:pe.categories.find(re=>re.id===a)||null},$=s=>{const a=d(s),n=typeof s=="string"?parseInt(s,10):s;return a?a.title:`Catégorie ${n}`},Z=[{header:"Référence",accessorKey:"application_number"},{header:"Candidat",accessorFn:s=>`${s.first_name} ${s.last_name}`},{header:"Projet",accessorKey:"project_name"},{header:"Catégorie",accessorKey:"category",cell:({row:s})=>{const a=d(s.original.category);return a?e.jsxs("div",{className:"max-w-[200px]",children:[e.jsx("div",{className:"font-medium text-sm text-gray-900 truncate",title:a.title,children:a.title}),e.jsx("div",{className:"text-xs text-gray-500 truncate",title:a.description,children:a.description})]}):e.jsx("div",{className:"max-w-[200px]",children:e.jsxs("span",{className:"text-sm text-gray-500 font-medium",children:["Catégorie ",s.original.category]})})}},{header:"Statut",accessorKey:"status",cell:({row:s})=>e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${ee(s.original.status)}`,children:b[s.original.status]})},{header:"Score",accessorKey:"score",cell:({row:s})=>e.jsx("span",{className:"font-mono",children:s.original.score?`${s.original.score}/100`:"-"})},{header:"Date",accessorKey:"submitted_at",cell:({row:s})=>new Date(s.original.submitted_at).toLocaleDateString("fr-FR")},{header:"Actions",cell:({row:s})=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(i,{variant:"outline",size:"sm",onClick:()=>window.location.href=route("admin.applications.show",s.original.id),className:"hover:bg-blue-50 hover:border-blue-300 transition-colors",title:"Voir les détails",children:e.jsx(Ne,{className:"h-4 w-4 text-blue-600"})}),e.jsx(i,{variant:"outline",size:"sm",onClick:()=>window.location.href=route("admin.applications.edit",s.original.id),className:"hover:bg-green-50 hover:border-green-300 transition-colors",title:"Modifier",children:e.jsx(ye,{className:"h-4 w-4 text-green-600"})}),e.jsx(i,{variant:"outline",size:"sm",onClick:()=>se(s.original),className:"hover:bg-red-50 hover:border-red-300 transition-colors",title:"Supprimer",children:e.jsx(E,{className:"h-4 w-4 text-red-600"})})]})}],ee=s=>({pending:"bg-yellow-100 text-yellow-800",validated:"bg-green-100 text-green-800",rejected:"bg-red-100 text-red-800",selected:"bg-blue-100 text-blue-800",finalist:"bg-purple-100 text-purple-800",winner:"bg-indigo-100 text-indigo-800"})[s]||"bg-gray-100 text-gray-800",R=()=>{window.location.href=route("admin.applications.export",{edition_id:o.id})},se=s=>{k(s),u(!0)},ae=()=>{r&&ne.delete(route("admin.applications.destroy",r.id),{onSuccess:()=>{u(!1),k(null)},onError:s=>{console.error("Erreur lors de la suppression:",s)}})},te=()=>{u(!1),k(null)};return e.jsxs(oe,{children:[e.jsx(le,{title:`Candidatures - ${o.name}`}),e.jsx("div",{className:"py-12",children:e.jsxs("div",{className:"max-w-7xl mx-auto sm:px-6 lg:px-8",children:[e.jsx("div",{className:"mb-6 bg-gradient-to-r from-blue-50 to-blue-100 rounded-lg p-6 shadow-md",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-6",children:[e.jsx(ie,{href:route("admin.applications.by-edition"),children:e.jsxs(i,{variant:"outline",size:"sm",className:"bg-white hover:bg-gray-50 transition-colors",children:[e.jsx(je,{className:"h-4 w-4 mr-2 text-blue-600"}),"Retour"]})}),e.jsxs("div",{children:[e.jsxs("h1",{className:"text-4xl font-extrabold text-gray-900 flex items-center gap-4",children:[e.jsx(I,{className:"h-10 w-10 text-blue-600 bg-white rounded-full p-2 shadow-md"}),o.name]}),e.jsxs("p",{className:"text-gray-600 mt-2 text-lg",children:["Édition ",o.year," - ",l.total," candidature",l.total>1?"s":""]})]})]}),e.jsxs(i,{onClick:R,className:"bg-green-500 hover:bg-green-600 text-white transition-colors shadow-md",children:[e.jsx(W,{className:"h-5 w-5 mr-2"}),"Exporter les candidatures"]})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-6",children:[e.jsx(m,{className:"hover:shadow-lg transition-shadow",children:e.jsx(x,{className:"p-6 bg-gradient-to-br from-blue-50 to-blue-100 rounded-lg",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"h-14 w-14 rounded-full bg-blue-200 flex items-center justify-center mr-5 shadow-md",children:e.jsx(be,{className:"h-7 w-7 text-blue-700"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-700 font-semibold",children:"Total candidatures"}),e.jsx("p",{className:"text-3xl font-bold text-blue-900",children:l.total})]})]})})}),e.jsx(m,{className:"hover:shadow-lg transition-shadow",children:e.jsx(x,{className:"p-6 bg-gradient-to-br from-green-50 to-green-100 rounded-lg",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"h-14 w-14 rounded-full bg-green-200 flex items-center justify-center mr-5 shadow-md",children:e.jsx(J,{className:"h-7 w-7 text-green-700"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-700 font-semibold",children:"Validées"}),e.jsx("p",{className:"text-3xl font-bold text-green-900",children:D("validated")})]})]})})}),e.jsx(m,{className:"hover:shadow-lg transition-shadow",children:e.jsx(x,{className:"p-6 bg-gradient-to-br from-yellow-50 to-yellow-100 rounded-lg",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"h-14 w-14 rounded-full bg-yellow-200 flex items-center justify-center mr-5 shadow-md",children:e.jsx(I,{className:"h-7 w-7 text-yellow-700"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-700 font-semibold",children:"En attente"}),e.jsx("p",{className:"text-3xl font-bold text-yellow-900",children:D("pending")})]})]})})}),e.jsx(m,{className:"hover:shadow-lg transition-shadow",children:e.jsx(x,{className:"p-6 bg-gradient-to-br from-purple-50 to-purple-100 rounded-lg",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"h-14 w-14 rounded-full bg-purple-200 flex items-center justify-center mr-5 shadow-md",children:e.jsx(J,{className:"h-7 w-7 text-purple-700"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-700 font-semibold",children:"Finalistes"}),e.jsx("p",{className:"text-3xl font-bold text-purple-900",children:D("finalist")})]})]})})})]}),e.jsxs(m,{className:"mb-6 bg-gradient-to-br from-gray-50 to-gray-100 shadow-lg",children:[e.jsxs(L,{className:"bg-white/50 backdrop-blur-sm rounded-t-lg border-b border-gray-200",children:[e.jsxs(O,{className:"flex items-center gap-3 text-xl font-bold text-gray-800",children:[e.jsx(X,{className:"h-6 w-6 text-blue-600"}),"Filtres de recherche"]}),e.jsx(V,{className:"text-gray-600",children:"Affinez votre recherche avec des filtres précis"})]}),e.jsxs(x,{className:"p-6 space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-4",children:[e.jsxs("div",{className:"lg:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Recherche"}),e.jsxs("div",{className:"relative",children:[e.jsx(fe,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-4 w-4"}),e.jsx(_,{placeholder:"Nom, projet, email...",className:"pl-10 bg-white border-gray-300 focus:ring-2 focus:ring-blue-500 transition-all",value:N,onChange:s=>y(s.target.value)})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Statut"}),e.jsxs(P,{value:h,onValueChange:v,children:[e.jsx(U,{className:"bg-white border-gray-300 focus:ring-2 focus:ring-blue-500 transition-all",children:e.jsx(q,{placeholder:"Tous les statuts"})}),e.jsxs(H,{className:"bg-white shadow-lg rounded-lg",children:[e.jsx(p,{value:"all",className:"hover:bg-gray-100 transition-colors",children:"Tous les statuts"}),Object.entries(b).map(([s,a])=>e.jsx(p,{value:s,className:"hover:bg-gray-100 transition-colors",children:a},s))]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Catégorie"}),e.jsxs(P,{value:g,onValueChange:w,children:[e.jsx(U,{className:"bg-white border-gray-300 focus:ring-2 focus:ring-blue-500 transition-all",children:e.jsx(q,{placeholder:"Toutes les catégories"})}),e.jsxs(H,{className:"bg-white shadow-lg rounded-lg",children:[e.jsx(p,{value:"all",className:"hover:bg-gray-100 transition-colors",children:"Toutes les catégories"}),A.map(s=>{const a=Number(s),n=d(a);return e.jsx(p,{value:a.toString(),className:"hover:bg-gray-100 transition-colors",children:e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"font-medium",children:(n==null?void 0:n.title)||`Catégorie ${a}`}),n&&e.jsx("span",{className:"text-xs text-gray-500 truncate max-w-[200px]",children:n.description})]})},a)})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Score"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(_,{type:"number",placeholder:"Min",min:"0",max:"100",value:C,onChange:s=>T(s.target.value),className:"w-20 bg-white border-gray-300 focus:ring-2 focus:ring-blue-500 transition-all"}),e.jsx("span",{className:"flex items-center text-gray-500",children:"-"}),e.jsx(_,{type:"number",placeholder:"Max",min:"0",max:"100",value:S,onChange:s=>M(s.target.value),className:"w-20 bg-white border-gray-300 focus:ring-2 focus:ring-blue-500 transition-all"})]})]})]}),e.jsxs("div",{className:"flex justify-between items-center mt-4",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(i,{onClick:Q,className:"bg-blue-600 hover:bg-blue-700 text-white transition-colors shadow-md",children:[e.jsx(X,{className:"h-4 w-4 mr-2"}),"Appliquer les filtres"]}),e.jsxs(i,{variant:"outline",onClick:Y,className:"border-gray-300 hover:bg-gray-100 transition-colors",children:[e.jsx(j,{className:"h-4 w-4 mr-2"}),"Réinitialiser"]})]}),e.jsxs("div",{className:"flex gap-2",children:[t.search&&e.jsxs(F,{variant:"secondary",className:"flex items-center gap-1 bg-blue-100 text-blue-800 hover:bg-blue-200 transition-colors",children:["Recherche: ",t.search,e.jsx(j,{className:"h-3 w-3 cursor-pointer text-blue-600 hover:text-blue-800",onClick:()=>y("")})]}),t.status&&e.jsxs(F,{variant:"secondary",className:"flex items-center gap-1 bg-green-100 text-green-800 hover:bg-green-200 transition-colors",children:["Statut: ",b[t.status],e.jsx(j,{className:"h-3 w-3 cursor-pointer text-green-600 hover:text-green-800",onClick:()=>v("all")})]}),t.category&&e.jsxs(F,{variant:"secondary",className:"flex items-center gap-1 bg-purple-100 text-purple-800 hover:bg-purple-200 transition-colors",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsxs("span",{className:"font-medium",children:["Catégorie: ",$(t.category)]}),d(t.category)&&e.jsx("span",{className:"text-xs opacity-75 truncate max-w-[150px]",children:(z=d(t.category))==null?void 0:z.description})]}),e.jsx(j,{className:"h-3 w-3 cursor-pointer text-purple-600 hover:text-purple-800",onClick:()=>w("all")})]})]})]})]})]}),e.jsxs(m,{children:[e.jsx(L,{children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsxs(O,{children:["Candidatures de l'édition ",o.name,t.category&&e.jsxs("span",{className:"ml-2 text-sm font-normal text-gray-600",children:["- Catégorie: ",$(t.category)]})]}),e.jsxs(V,{children:["Liste des candidatures soumises pour cette édition",t.category&&e.jsx("span",{className:"block text-xs text-gray-500 mt-1",children:(K=d(t.category))==null?void 0:K.description})]})]}),e.jsxs(i,{onClick:R,children:[e.jsx(W,{className:"h-4 w-4 mr-2"}),"Exporter"]})]})}),e.jsx(x,{children:e.jsx(ce,{columns:Z,data:l.data,pagination:{pageIndex:l.current_page-1,pageSize:l.per_page,pageCount:Math.ceil(l.total/l.per_page),total:l.total}})})]})]})}),e.jsx(de,{open:G,onOpenChange:u,children:e.jsxs(me,{className:"max-w-md",children:[e.jsxs(xe,{children:[e.jsxs(he,{className:"text-red-600 flex items-center gap-2",children:[e.jsx(E,{className:"h-5 w-5"}),"Confirmer la suppression"]}),e.jsxs(ge,{className:"text-gray-600",children:["Êtes-vous sûr de vouloir supprimer la candidature de"," ",e.jsxs("span",{className:"font-semibold text-gray-900",children:[r==null?void 0:r.first_name," ",r==null?void 0:r.last_name]})," ","pour le projet"," ",e.jsxs("span",{className:"font-semibold text-gray-900",children:['"',r==null?void 0:r.project_name,'"']}),"?",e.jsx("br",{}),e.jsx("br",{}),e.jsx("span",{className:"text-red-600 font-medium",children:"Cette action est irréversible et supprimera définitivement tous les fichiers associés."})]})]}),e.jsxs(ue,{className:"gap-2",children:[e.jsx(i,{variant:"outline",onClick:te,className:"border-gray-300 hover:bg-gray-100 transition-colors",children:"Annuler"}),e.jsxs(i,{onClick:ae,className:"bg-red-600 hover:bg-red-700 text-white transition-colors",children:[e.jsx(E,{className:"h-4 w-4 mr-2"}),"Supprimer définitivement"]})]})]})})]})}export{es as default};
