import{r as m,j as e,B as Q,W as Y}from"./app-Cbu2kkMp.js";import{A as Z}from"./app-layout-BqKCciPt.js";import{D as ee}from"./data-table-Cmh1J7jt.js";import{B as n}from"./button-ChbHnhGx.js";import{C as c,d,a as B,b as M,c as K}from"./card-CqKD61Iv.js";import{I as S}from"./input-DnOHabyC.js";import{B as k}from"./badge-OPb8LYI7.js";import{S as z,a as L,b as V,c as P,d as h}from"./select-DCm4ivmT.js";import{F as se}from"./index-CeMi3bgD.js";import{A as te}from"./arrow-left-C5iQ3uLX.js";import{C as U}from"./calendar-BtzOEuS8.js";import{D as q}from"./download-D0RwUQ-t.js";import{F as ae}from"./index-Bfiwr-vO.js";import{U as I}from"./users-BKWdWJyH.js";import{F as O}from"./filter-C0tf7bzL.js";import{S as re}from"./search-CEbJ68YH.js";import{X as u}from"./x-D1MCDg2u.js";import{E as le}from"./eye-CsNOu1yk.js";import{S as ie}from"./square-pen-CFgSblls.js";import"./index-B1o6TpKF.js";import"./index-Cs17BmTR.js";import"./index-D5L3M-DN.js";import"./createLucideIcon-CvyvGDtA.js";import"./app-logo-icon-BAise0iR.js";import"./clock-B__Chc10.js";import"./circle-check-big-DyutnEEV.js";import"./table-CBTWs4Ib.js";import"./index-Bxs8Fj53.js";import"./check-3gH4khzd.js";import"./trophy-FqfEtYr_.js";function Ke({edition:i,applications:r,statuses:p,categories:j,filters:a}){var $,R,A;const[b,f]=m.useState(a.search||""),[x,N]=m.useState(a.status||"all"),[g,y]=m.useState((($=a.category)==null?void 0:$.toString())||"all"),[w,_]=m.useState(a.score_min||""),[v,F]=m.useState(a.score_max||"");console.log("Categories reçues:",j),console.log("Types des catégories:",j.map(s=>typeof s));const T=j.map(s=>typeof s=="string"?parseInt(s,10):s).filter(s=>s!=null&&!isNaN(s)&&s>0&&s<=5);console.log("Catégories nettoyées:",T);const W=()=>{const s=new URLSearchParams;b&&s.append("search",b),x&&x!=="all"&&s.append("status",x),g&&g!=="all"&&s.append("category",g),w&&s.append("score_min",w.toString()),v&&s.append("score_max",v.toString()),window.location.href=`${route("admin.applications.by-edition.show",i.id)}?${s.toString()}`},H=()=>{f(""),N("all"),y("all"),_(""),F(""),window.location.href=route("admin.applications.by-edition.show",i.id)},C=s=>r.data.filter(t=>t.status===s).length,o=s=>{const t=typeof s=="string"?parseInt(s,10):s;return!t||t<=0||t>5||isNaN(t)?null:se.categories.find(G=>G.id===t)||null},D=s=>{const t=o(s),l=typeof s=="string"?parseInt(s,10):s;return t?t.title:`Catégorie ${l}`},J=[{header:"Référence",accessorKey:"application_number"},{header:"Candidat",accessorFn:s=>`${s.first_name} ${s.last_name}`},{header:"Projet",accessorKey:"project_name"},{header:"Catégorie",accessorKey:"category",cell:({row:s})=>{const t=o(s.original.category);return t?e.jsxs("div",{className:"max-w-[200px]",children:[e.jsx("div",{className:"font-medium text-sm text-gray-900 truncate",title:t.title,children:t.title}),e.jsx("div",{className:"text-xs text-gray-500 truncate",title:t.description,children:t.description})]}):e.jsx("div",{className:"max-w-[200px]",children:e.jsxs("span",{className:"text-sm text-gray-500 font-medium",children:["Catégorie ",s.original.category]})})}},{header:"Statut",accessorKey:"status",cell:({row:s})=>e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${X(s.original.status)}`,children:p[s.original.status]})},{header:"Score",accessorKey:"score",cell:({row:s})=>e.jsx("span",{className:"font-mono",children:s.original.score?`${s.original.score}/100`:"-"})},{header:"Date",accessorKey:"submitted_at",cell:({row:s})=>new Date(s.original.submitted_at).toLocaleDateString("fr-FR")},{header:"Actions",cell:({row:s})=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(n,{variant:"outline",size:"sm",onClick:()=>window.location.href=route("admin.applications.show",s.original.id),children:e.jsx(le,{className:"h-4 w-4"})}),e.jsx(n,{variant:"outline",size:"sm",onClick:()=>window.location.href=route("admin.applications.edit",s.original.id),children:e.jsx(ie,{className:"h-4 w-4"})})]})}],X=s=>({pending:"bg-yellow-100 text-yellow-800",validated:"bg-green-100 text-green-800",rejected:"bg-red-100 text-red-800",selected:"bg-blue-100 text-blue-800",finalist:"bg-purple-100 text-purple-800",winner:"bg-indigo-100 text-indigo-800"})[s]||"bg-gray-100 text-gray-800",E=()=>{window.location.href=route("admin.applications.export",{edition_id:i.id})};return e.jsxs(Z,{children:[e.jsx(Q,{title:`Candidatures - ${i.name}`}),e.jsx("div",{className:"py-12",children:e.jsxs("div",{className:"max-w-7xl mx-auto sm:px-6 lg:px-8",children:[e.jsx("div",{className:"mb-6 bg-gradient-to-r from-blue-50 to-blue-100 rounded-lg p-6 shadow-md",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-6",children:[e.jsx(Y,{href:route("admin.applications.by-edition"),children:e.jsxs(n,{variant:"outline",size:"sm",className:"bg-white hover:bg-gray-50 transition-colors",children:[e.jsx(te,{className:"h-4 w-4 mr-2 text-blue-600"}),"Retour"]})}),e.jsxs("div",{children:[e.jsxs("h1",{className:"text-4xl font-extrabold text-gray-900 flex items-center gap-4",children:[e.jsx(U,{className:"h-10 w-10 text-blue-600 bg-white rounded-full p-2 shadow-md"}),i.name]}),e.jsxs("p",{className:"text-gray-600 mt-2 text-lg",children:["Édition ",i.year," - ",r.total," candidature",r.total>1?"s":""]})]})]}),e.jsxs(n,{onClick:E,className:"bg-green-500 hover:bg-green-600 text-white transition-colors shadow-md",children:[e.jsx(q,{className:"h-5 w-5 mr-2"}),"Exporter les candidatures"]})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-6",children:[e.jsx(c,{className:"hover:shadow-lg transition-shadow",children:e.jsx(d,{className:"p-6 bg-gradient-to-br from-blue-50 to-blue-100 rounded-lg",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"h-14 w-14 rounded-full bg-blue-200 flex items-center justify-center mr-5 shadow-md",children:e.jsx(ae,{className:"h-7 w-7 text-blue-700"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-700 font-semibold",children:"Total candidatures"}),e.jsx("p",{className:"text-3xl font-bold text-blue-900",children:r.total})]})]})})}),e.jsx(c,{className:"hover:shadow-lg transition-shadow",children:e.jsx(d,{className:"p-6 bg-gradient-to-br from-green-50 to-green-100 rounded-lg",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"h-14 w-14 rounded-full bg-green-200 flex items-center justify-center mr-5 shadow-md",children:e.jsx(I,{className:"h-7 w-7 text-green-700"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-700 font-semibold",children:"Validées"}),e.jsx("p",{className:"text-3xl font-bold text-green-900",children:C("validated")})]})]})})}),e.jsx(c,{className:"hover:shadow-lg transition-shadow",children:e.jsx(d,{className:"p-6 bg-gradient-to-br from-yellow-50 to-yellow-100 rounded-lg",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"h-14 w-14 rounded-full bg-yellow-200 flex items-center justify-center mr-5 shadow-md",children:e.jsx(U,{className:"h-7 w-7 text-yellow-700"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-700 font-semibold",children:"En attente"}),e.jsx("p",{className:"text-3xl font-bold text-yellow-900",children:C("pending")})]})]})})}),e.jsx(c,{className:"hover:shadow-lg transition-shadow",children:e.jsx(d,{className:"p-6 bg-gradient-to-br from-purple-50 to-purple-100 rounded-lg",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"h-14 w-14 rounded-full bg-purple-200 flex items-center justify-center mr-5 shadow-md",children:e.jsx(I,{className:"h-7 w-7 text-purple-700"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-700 font-semibold",children:"Finalistes"}),e.jsx("p",{className:"text-3xl font-bold text-purple-900",children:C("finalist")})]})]})})})]}),e.jsxs(c,{className:"mb-6 bg-gradient-to-br from-gray-50 to-gray-100 shadow-lg",children:[e.jsxs(B,{className:"bg-white/50 backdrop-blur-sm rounded-t-lg border-b border-gray-200",children:[e.jsxs(M,{className:"flex items-center gap-3 text-xl font-bold text-gray-800",children:[e.jsx(O,{className:"h-6 w-6 text-blue-600"}),"Filtres de recherche"]}),e.jsx(K,{className:"text-gray-600",children:"Affinez votre recherche avec des filtres précis"})]}),e.jsxs(d,{className:"p-6 space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-4",children:[e.jsxs("div",{className:"lg:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Recherche"}),e.jsxs("div",{className:"relative",children:[e.jsx(re,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-4 w-4"}),e.jsx(S,{placeholder:"Nom, projet, email...",className:"pl-10 bg-white border-gray-300 focus:ring-2 focus:ring-blue-500 transition-all",value:b,onChange:s=>f(s.target.value)})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Statut"}),e.jsxs(z,{value:x,onValueChange:N,children:[e.jsx(L,{className:"bg-white border-gray-300 focus:ring-2 focus:ring-blue-500 transition-all",children:e.jsx(V,{placeholder:"Tous les statuts"})}),e.jsxs(P,{className:"bg-white shadow-lg rounded-lg",children:[e.jsx(h,{value:"all",className:"hover:bg-gray-100 transition-colors",children:"Tous les statuts"}),Object.entries(p).map(([s,t])=>e.jsx(h,{value:s,className:"hover:bg-gray-100 transition-colors",children:t},s))]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Catégorie"}),e.jsxs(z,{value:g,onValueChange:y,children:[e.jsx(L,{className:"bg-white border-gray-300 focus:ring-2 focus:ring-blue-500 transition-all",children:e.jsx(V,{placeholder:"Toutes les catégories"})}),e.jsxs(P,{className:"bg-white shadow-lg rounded-lg",children:[e.jsx(h,{value:"all",className:"hover:bg-gray-100 transition-colors",children:"Toutes les catégories"}),T.map(s=>{const t=Number(s),l=o(t);return e.jsx(h,{value:t.toString(),className:"hover:bg-gray-100 transition-colors",children:e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"font-medium",children:(l==null?void 0:l.title)||`Catégorie ${t}`}),l&&e.jsx("span",{className:"text-xs text-gray-500 truncate max-w-[200px]",children:l.description})]})},t)})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Score"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(S,{type:"number",placeholder:"Min",min:"0",max:"100",value:w,onChange:s=>_(s.target.value),className:"w-20 bg-white border-gray-300 focus:ring-2 focus:ring-blue-500 transition-all"}),e.jsx("span",{className:"flex items-center text-gray-500",children:"-"}),e.jsx(S,{type:"number",placeholder:"Max",min:"0",max:"100",value:v,onChange:s=>F(s.target.value),className:"w-20 bg-white border-gray-300 focus:ring-2 focus:ring-blue-500 transition-all"})]})]})]}),e.jsxs("div",{className:"flex justify-between items-center mt-4",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(n,{onClick:W,className:"bg-blue-600 hover:bg-blue-700 text-white transition-colors shadow-md",children:[e.jsx(O,{className:"h-4 w-4 mr-2"}),"Appliquer les filtres"]}),e.jsxs(n,{variant:"outline",onClick:H,className:"border-gray-300 hover:bg-gray-100 transition-colors",children:[e.jsx(u,{className:"h-4 w-4 mr-2"}),"Réinitialiser"]})]}),e.jsxs("div",{className:"flex gap-2",children:[a.search&&e.jsxs(k,{variant:"secondary",className:"flex items-center gap-1 bg-blue-100 text-blue-800 hover:bg-blue-200 transition-colors",children:["Recherche: ",a.search,e.jsx(u,{className:"h-3 w-3 cursor-pointer text-blue-600 hover:text-blue-800",onClick:()=>f("")})]}),a.status&&e.jsxs(k,{variant:"secondary",className:"flex items-center gap-1 bg-green-100 text-green-800 hover:bg-green-200 transition-colors",children:["Statut: ",p[a.status],e.jsx(u,{className:"h-3 w-3 cursor-pointer text-green-600 hover:text-green-800",onClick:()=>N("all")})]}),a.category&&e.jsxs(k,{variant:"secondary",className:"flex items-center gap-1 bg-purple-100 text-purple-800 hover:bg-purple-200 transition-colors",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsxs("span",{className:"font-medium",children:["Catégorie: ",D(a.category)]}),o(a.category)&&e.jsx("span",{className:"text-xs opacity-75 truncate max-w-[150px]",children:(R=o(a.category))==null?void 0:R.description})]}),e.jsx(u,{className:"h-3 w-3 cursor-pointer text-purple-600 hover:text-purple-800",onClick:()=>y("all")})]})]})]})]})]}),e.jsxs(c,{children:[e.jsx(B,{children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsxs(M,{children:["Candidatures de l'édition ",i.name,a.category&&e.jsxs("span",{className:"ml-2 text-sm font-normal text-gray-600",children:["- Catégorie: ",D(a.category)]})]}),e.jsxs(K,{children:["Liste des candidatures soumises pour cette édition",a.category&&e.jsx("span",{className:"block text-xs text-gray-500 mt-1",children:(A=o(a.category))==null?void 0:A.description})]})]}),e.jsxs(n,{onClick:E,children:[e.jsx(q,{className:"h-4 w-4 mr-2"}),"Exporter"]})]})}),e.jsx(d,{children:e.jsx(ee,{columns:J,data:r.data,pagination:{pageIndex:r.current_page-1,pageSize:r.per_page,pageCount:Math.ceil(r.total/r.per_page),total:r.total}})})]})]})})]})}export{Ke as default};
