import{U as g,r as l,b as h,j as e,W as i,B as M}from"./app-BHdtU-jg.js";import{D as v,a as w,b as C,c as n,d as z,A as F}from"./app-layout-DF6-JRv-.js";import{B as t}from"./button-gHGIsv9P.js";import{I as P}from"./input-B0V14bQ4.js";import{B as u}from"./badge-ChmX8Oig.js";import{T as I,a as H,b as p,c as o,d as U,e as c}from"./table-CGsv427A.js";import{C as V,a as G,b as W,c as q,d as $}from"./card-t-pYRpV3.js";import{E as J}from"./eye-DDD6Ol0s.js";import{P as K}from"./pencil-Dvjh3EWO.js";import{E as O}from"./ellipsis-CasZyagv.js";import{F as y}from"./index-CGRYAKMI.js";import{R as Q}from"./rotate-ccw-CFahE0om.js";import{T as E}from"./trash-BMbwYtvL.js";import{C as j}from"./calendar-B5nMNvaE.js";import{D as X}from"./download-ByzXcZKf.js";import{A as Y}from"./archive-DEeMZ2Jr.js";import{P as Z}from"./plus-DZPJtS-0.js";import{S as ee}from"./search-Cw246KtF.js";import{T as se}from"./timer-CiPuFHXn.js";import{U as re}from"./users-0s4CEyF-.js";import{A as ae}from"./arrow-left-DEcuI5sp.js";import{A as te}from"./arrow-right-3FIfB8HF.js";import"./index-Bt_uVT_d.js";import"./index-B4257H-3.js";import"./index-C-CQccfE.js";import"./x-nG2A5Ktv.js";import"./createLucideIcon-q54nbVAu.js";import"./app-logo-icon-CPaG22hb.js";const Le=g.memo(function({editions:r}){const[f,D]=l.useState(""),[d,S]=l.useState(""),m=l.useRef(null),T=l.useCallback(s=>{const a=s.target.value;D(a),m.current&&clearTimeout(m.current),m.current=setTimeout(()=>{S(a)},300)},[]),b=l.useMemo(()=>{if(!d.trim())return r.data;const s=d.toLowerCase();return r.data.filter(a=>{var N;return a.name.toLowerCase().includes(s)||((N=a.description)==null?void 0:N.toLowerCase().includes(s))})},[r.data,d]),A={draft:"bg-gray-100 text-gray-800 hover:bg-gray-200",published:"bg-blue-100 text-blue-800 hover:bg-blue-200",active:"bg-green-100 text-green-800 hover:bg-green-200",completed:"bg-purple-100 text-purple-800 hover:bg-purple-200",archived:"bg-amber-100 text-amber-800 hover:bg-amber-200"},_={draft:"Brouillon",published:"Publié",active:"Actif",completed:"Terminé",archived:"Archivé"},k=l.useCallback(s=>{confirm("Êtes-vous sûr de vouloir supprimer cette édition ?")&&h.delete(route("admin.editions.destroy",s),{onSuccess:()=>{},onError:a=>{console.error("Erreur lors de la suppression:",a)}})},[]),R=l.useCallback(s=>{h.post(route("admin.editions.restore",s),{},{onSuccess:()=>{},onError:a=>{console.error("Erreur lors de la restauration:",a)}})},[]),B=l.useCallback(s=>{confirm("Êtes-vous sûr de vouloir supprimer définitivement cette édition ? Cette action est irréversible.")&&h.delete(route("admin.editions.force-delete",s),{onSuccess:()=>{},onError:a=>{console.error("Erreur lors de la suppression définitive:",a)}})},[]);l.useEffect(()=>()=>{m.current&&clearTimeout(m.current)},[]);const x=s=>s?new Date(s).toLocaleDateString("fr-FR",{day:"numeric",month:"long",year:"numeric"}):"Non définie",L=g.memo(function({edition:a}){return e.jsxs("div",{className:"flex justify-end space-x-2",children:[e.jsx(i,{href:route("admin.editions.show",a.id),children:e.jsx(t,{variant:"outline",size:"sm",className:"h-8 w-8 p-0",children:e.jsx(J,{className:"h-4 w-4"})})}),e.jsx(i,{href:route("admin.editions.edit",a.id),children:e.jsx(t,{variant:"outline",size:"sm",className:"h-8 w-8 p-0",children:e.jsx(K,{className:"h-4 w-4"})})}),e.jsxs(v,{children:[e.jsx(w,{asChild:!0,children:e.jsx(t,{variant:"outline",size:"sm",className:"h-8 w-8 p-0",children:e.jsx(O,{className:"h-4 w-4"})})}),e.jsxs(C,{align:"end",children:[e.jsx(n,{children:e.jsxs(i,{href:route("admin.applications.by-edition.show",a.id),className:"flex items-center w-full",children:[e.jsx(y,{className:"h-4 w-4 mr-2"}),"Voir les candidatures"]})}),e.jsx(n,{children:"Définir comme courante"}),e.jsx(n,{children:"Dupliquer"}),e.jsx(z,{}),a.deleted_at?e.jsxs(e.Fragment,{children:[e.jsxs(n,{onClick:()=>R(a.id),children:[e.jsx(Q,{className:"h-4 w-4 mr-2"}),"Restaurer"]}),e.jsxs(n,{className:"text-red-600",onClick:()=>B(a.id),children:[e.jsx(E,{className:"h-4 w-4 mr-2"}),"Supprimer définitivement"]})]}):e.jsxs(n,{className:"text-red-600",onClick:()=>k(a.id),children:[e.jsx(E,{className:"h-4 w-4 mr-2"}),"Supprimer"]})]})]})]})});return e.jsxs(F,{children:[e.jsx(M,{title:"Gestion des éditions"}),e.jsx("div",{className:"py-8",children:e.jsx("div",{className:"max-w-7xl mx-auto sm:px-6 lg:px-8",children:e.jsxs(V,{className:"shadow-lg border-t-4 border-t-green-500",children:[e.jsx(G,{className:"bg-slate-50 border-b",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsxs(W,{className:"text-2xl flex items-center",children:[e.jsx(j,{className:"h-6 w-6 mr-2 text-green-500"}),"Gestion des éditions"]}),e.jsxs(q,{className:"text-slate-500",children:[r.total," édition",r.total>1?"s":""," au total"]})]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsxs(v,{children:[e.jsx(w,{asChild:!0,children:e.jsxs(t,{variant:"outline",className:"flex items-center",children:[e.jsx(X,{className:"h-4 w-4 mr-2"}),"Exporter"]})}),e.jsxs(C,{align:"end",children:[e.jsx(n,{children:"Export CSV"}),e.jsx(n,{children:"Export Excel"}),e.jsx(n,{children:"Export PDF"})]})]}),e.jsx(i,{href:route("admin.editions.trashed"),children:e.jsxs(t,{variant:"outline",className:"flex items-center",children:[e.jsx(Y,{className:"h-4 w-4 mr-2"}),"Éditions supprimées"]})}),e.jsx(i,{href:route("admin.editions.create"),children:e.jsxs(t,{className:"flex items-center bg-green-600 hover:bg-green-700",children:[e.jsx(Z,{className:"h-4 w-4 mr-2"}),"Nouvelle édition"]})})]})]})}),e.jsxs($,{className:"p-6",children:[e.jsx("div",{className:"mb-6 flex flex-wrap gap-4 justify-between items-center",children:e.jsxs("div",{className:"relative flex-1 min-w-[250px]",children:[e.jsx(ee,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-4 w-4"}),e.jsx(P,{placeholder:"Rechercher une édition...",className:"pl-10",value:f,onChange:T})]})}),e.jsx("div",{className:"rounded-lg border overflow-hidden",children:e.jsxs(I,{children:[e.jsx(H,{children:e.jsxs(p,{className:"bg-slate-50",children:[e.jsx(o,{className:"text-slate-700 font-semibold",children:"Édition"}),e.jsx(o,{className:"text-slate-700 font-semibold",children:"Période"}),e.jsx(o,{className:"text-slate-700 font-semibold",children:"Inscriptions"}),e.jsx(o,{className:"text-slate-700 font-semibold",children:"Candidatures"}),e.jsx(o,{className:"text-slate-700 font-semibold",children:"Statut"}),e.jsx(o,{className:"text-right text-slate-700 font-semibold",children:"Actions"})]})}),e.jsx(U,{children:b.length>0?b.map(s=>e.jsxs(p,{className:"hover:bg-slate-50",children:[e.jsx(c,{className:"font-medium",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"h-10 w-10 rounded-full bg-green-100 flex items-center justify-center text-green-600 font-bold",children:s.year.toString().slice(-2)}),e.jsxs("div",{children:[e.jsxs("div",{className:"font-semibold",children:[s.name,s.is_current&&e.jsx(u,{className:"ml-2 bg-green-100 text-green-800 hover:bg-green-200",children:"Courante"}),s.deleted_at&&e.jsx(u,{className:"ml-2 bg-red-100 text-red-800 hover:bg-red-200",children:"Supprimée"})]}),e.jsxs("div",{className:"text-sm text-slate-500",children:["Année: ",s.year]})]})]})}),e.jsx(c,{children:e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex items-center text-sm",children:[e.jsx(j,{className:"h-3 w-3 mr-2 text-slate-400"}),"Du ",x(s.start_date)]}),e.jsxs("div",{className:"flex items-center text-sm text-slate-500",children:[e.jsx(j,{className:"h-3 w-3 mr-2 text-slate-400"}),"Au ",x(s.end_date)]})]})}),e.jsx(c,{children:e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex items-center text-sm",children:[e.jsx(se,{className:"h-3 w-3 mr-2 text-slate-400"}),"Fin: ",x(s.registration_deadline)]}),e.jsxs("div",{className:"flex items-center text-sm text-slate-500",children:[e.jsx(re,{className:"h-3 w-3 mr-2 text-slate-400"}),"Max: ",s.max_participants," participants"]})]})}),e.jsx(c,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center text-sm",children:[e.jsx(y,{className:"h-4 w-4 mr-2 text-blue-500"}),e.jsx("span",{className:"font-medium",children:s.applications_count||0}),e.jsxs("span",{className:"text-slate-500 ml-1",children:["candidature",(s.applications_count||0)>1?"s":""]})]}),e.jsx(i,{href:route("admin.applications.by-edition.show",s.id),children:e.jsx(t,{variant:"outline",size:"sm",className:"h-6 px-2 text-xs",children:"Voir"})})]})}),e.jsx(c,{children:e.jsx(u,{className:`${A[s.status]||"bg-gray-100 text-gray-800"}`,children:_[s.status]||s.status})}),e.jsx(c,{className:"text-right",children:e.jsx(L,{edition:s})})]},s.id)):e.jsx(p,{children:e.jsx(c,{colSpan:6,className:"text-center py-8 text-gray-500",children:f?"Aucune édition ne correspond à votre recherche":"Aucune édition trouvée"})})})]})}),r.last_page>1&&e.jsxs("div",{className:"flex items-center justify-between mt-6",children:[e.jsxs("div",{className:"text-sm text-gray-600",children:["Affichage de ",(r.current_page-1)*r.per_page+1," à ",Math.min(r.current_page*r.per_page,r.total)," sur ",r.total," éditions"]}),e.jsxs("div",{className:"flex space-x-1",children:[e.jsx(i,{href:r.links[0].url||"#",disabled:!r.links[0].url,children:e.jsx(t,{variant:"outline",size:"sm",disabled:!r.links[0].url,children:e.jsx(ae,{className:"h-4 w-4"})})}),r.links.slice(1,-1).map((s,a)=>e.jsx(i,{href:s.url||"#",disabled:!s.url,children:e.jsx(t,{variant:s.active?"default":"outline",size:"sm",disabled:!s.url,children:s.label})},a)),e.jsx(i,{href:r.links[r.links.length-1].url||"#",disabled:!r.links[r.links.length-1].url,children:e.jsx(t,{variant:"outline",size:"sm",disabled:!r.links[r.links.length-1].url,children:e.jsx(te,{className:"h-4 w-4"})})})]})]})]})]})})})]})});export{Le as default};
