import{r as x,j as e,B as K}from"./app-DvwYORMh.js";import{A as $}from"./app-layout-nW5gPRKY.js";import{F as R,D as L}from"./data-table-BMyDh0vN.js";import{B as m}from"./button-CQQlbXvm.js";import{I as P}from"./input-C_j_ys4p.js";import{S as u}from"./select-wrnrkMaR.js";import{C as r,a as i,b as p,c as f,d as N}from"./card-mcPbQmcC.js";import{B as y}from"./badge-C94mvrLn.js";import{F as b}from"./index-Dmzhg338.js";import{D as U}from"./download-Cx-ovCym.js";import{U as v}from"./users-C3_tBJjS.js";import{C as w}from"./calendar-B-VGunfp.js";import{S as G}from"./search-C_6AeMJh.js";import{E as H}from"./eye-Bn1Vixyh.js";import{S as q}from"./square-pen-7O0MjyKO.js";import"./index-XYEWX3qu.js";import"./index-CN9p1dlp.js";import"./index-DYj5555m.js";import"./x-XWWRALWT.js";import"./createLucideIcon-B2K1Nsdj.js";import"./app-logo-icon-BL9Om477.js";import"./table-CloQ0MmV.js";import"./chevron-left-BbrTzO05.js";import"./index-CYMY4nmV.js";import"./check-DGVItuFN.js";function pe({applications:t,editions:S,filters:h,statuses:j}){const[n,C]=x.useState(h.search||""),[c,_]=x.useState(h.edition_id||""),[d,E]=x.useState(h.status||""),[o,F]=x.useState(h.category||""),[l,g]=x.useState([]),T=s=>{g(a=>a.includes(s)?a.filter(I=>I!==s):[...a,s])},V=()=>{l.length===t.data.length?g([]):g(t.data.map(s=>s.id))},k=[{id:"select",header:()=>e.jsx("input",{type:"checkbox",checked:l.length===t.data.length&&t.data.length>0,onChange:V,className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),cell:({row:s})=>e.jsx("input",{type:"checkbox",checked:l.includes(s.original.id),onChange:()=>T(s.original.id),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),enableSorting:!1,enableHiding:!1},{header:"Référence",accessorKey:"application_number",cell:({row:s})=>e.jsx("a",{href:route("admin.applications.show",s.original.id),className:"font-mono text-sm text-blue-600 hover:underline",children:s.original.application_number})},{header:"Candidat",accessorFn:s=>`${s.first_name} ${s.last_name}`,cell:({row:s})=>e.jsx("div",{className:"font-medium text-gray-900",children:s.getValue("Candidat")})},{header:"Projet",accessorKey:"project_name",cell:({row:s})=>e.jsx("div",{className:"max-w-[200px] truncate",title:s.getValue("project_name"),children:s.getValue("project_name")})},{header:"Catégorie",accessorKey:"category",cell:({row:s})=>e.jsx(y,{variant:"outline",className:"text-xs",children:s.getValue("category")})},{header:"Édition",accessorFn:s=>`${s.edition.name} (${s.edition.year})`,cell:({row:s})=>e.jsxs("div",{className:"flex items-center gap-1 text-sm text-gray-600",children:[e.jsx(w,{className:"h-3 w-3"}),s.getValue("Édition")]})},{header:"Statut",accessorKey:"status",cell:({row:s})=>e.jsx(y,{className:D(s.original.status),children:j[s.original.status]})},{header:"Score",accessorKey:"score",cell:({row:s})=>e.jsx("div",{className:"text-center",children:s.original.score?e.jsxs("span",{className:"font-mono text-sm bg-gray-100 px-2 py-1 rounded",children:[s.original.score,"/100"]}):e.jsx("span",{className:"text-gray-400",children:"-"})})},{header:"Date",accessorKey:"submitted_at",cell:({row:s})=>e.jsx("div",{className:"text-sm text-gray-600",children:new Date(s.original.submitted_at).toLocaleDateString("fr-FR")})},{header:"Actions",cell:({row:s})=>e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(m,{variant:"outline",size:"sm",onClick:()=>window.location.href=route("admin.applications.show",s.original.id),className:"h-8 w-8 p-0",children:e.jsx(H,{className:"h-4 w-4"})}),e.jsx(m,{variant:"outline",size:"sm",onClick:()=>window.location.href=route("admin.applications.edit",s.original.id),className:"h-8 w-8 p-0",children:e.jsx(q,{className:"h-4 w-4"})})]})}],D=s=>({pending:"bg-yellow-100 text-yellow-800",validated:"bg-green-100 text-green-800",rejected:"bg-red-100 text-red-800",selected:"bg-blue-100 text-blue-800",finalist:"bg-purple-100 text-purple-800",winner:"bg-indigo-100 text-indigo-800"})[s]||"bg-gray-100 text-gray-800",z=()=>{window.location.href=route("admin.applications.index",{search:n,edition_id:c,status:d,category:o})},A=()=>{window.location.href=route("admin.applications.export",{search:n,edition_id:c,status:d,category:o})},B=()=>{if(l.length===0){alert("Veuillez sélectionner au moins une candidature à exporter.");return}const s=new URLSearchParams;l.forEach(a=>{s.append("application_ids[]",a.toString())}),n&&s.append("search",n),c&&s.append("edition_id",c),d&&s.append("status",d),o&&s.append("category",o),window.location.href=`${route("admin.applications.export-folders")}?${s.toString()}`};return e.jsxs($,{children:[e.jsx(K,{title:"Gestion des candidatures"}),e.jsx("div",{className:"py-8",children:e.jsxs("div",{className:"max-w-5xl mx-auto px-4 sm:px-6 lg:px-8",children:[e.jsx("div",{className:"mb-6",children:e.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center lg:justify-between gap-4",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-3xl font-bold text-gray-900 flex items-center gap-3",children:[e.jsx(b,{className:"h-8 w-8 text-blue-600"}),"Gestion des candidatures"]}),e.jsx("p",{className:"mt-2 text-gray-600",children:"Consultez et gérez toutes les candidatures soumises"})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 w-full lg:w-auto",children:[e.jsxs(m,{onClick:A,className:"bg-green-600 hover:bg-green-700",children:[e.jsx(U,{className:"w-4 h-4 mr-2"}),"Exporter Excel"]}),e.jsxs(m,{onClick:B,className:"bg-blue-600 hover:bg-blue-700",disabled:l.length===0,children:[e.jsx(R,{className:"w-4 h-4 mr-2"}),"Exporter Dossiers (",l.length,")"]})]})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[e.jsx(r,{children:e.jsx(i,{className:"p-4",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"h-10 w-10 rounded-full bg-blue-100 flex items-center justify-center mr-3",children:e.jsx(b,{className:"h-5 w-5 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Total"}),e.jsx("p",{className:"text-xl font-bold text-gray-900",children:t.total})]})]})})}),e.jsx(r,{children:e.jsx(i,{className:"p-4",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"h-10 w-10 rounded-full bg-green-100 flex items-center justify-center mr-3",children:e.jsx(v,{className:"h-5 w-5 text-green-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Validées"}),e.jsx("p",{className:"text-xl font-bold text-gray-900",children:t.data.filter(s=>s.status==="validated").length})]})]})})}),e.jsx(r,{children:e.jsx(i,{className:"p-4",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"h-10 w-10 rounded-full bg-yellow-100 flex items-center justify-center mr-3",children:e.jsx(w,{className:"h-5 w-5 text-yellow-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"En attente"}),e.jsx("p",{className:"text-xl font-bold text-gray-900",children:t.data.filter(s=>s.status==="pending").length})]})]})})}),e.jsx(r,{children:e.jsx(i,{className:"p-4",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"h-10 w-10 rounded-full bg-purple-100 flex items-center justify-center mr-3",children:e.jsx(v,{className:"h-5 w-5 text-purple-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Finalistes"}),e.jsx("p",{className:"text-xl font-bold text-gray-900",children:t.data.filter(s=>s.status==="finalist").length})]})]})})})]}),e.jsxs(r,{className:"mb-6",children:[e.jsxs(p,{children:[e.jsx(f,{className:"text-lg",children:"Filtres de recherche"}),e.jsx(N,{children:"Affinez votre recherche selon vos critères"})]}),e.jsx(i,{children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Recherche"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(P,{type:"text",placeholder:"Nom, email, projet...",value:n,onChange:s=>C(s.target.value),className:"flex-1"}),e.jsx(m,{variant:"outline",onClick:z,size:"sm",children:e.jsx(G,{className:"w-4 h-4"})})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Édition"}),e.jsxs(u,{value:c,onValueChange:s=>_(s),children:[e.jsx("option",{value:"",children:"Toutes les éditions"}),S.map(s=>e.jsxs("option",{value:s.id,children:[s.name," (",s.year,")"]},s.id))]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Statut"}),e.jsxs(u,{value:d,onValueChange:s=>E(s),children:[e.jsx("option",{value:"",children:"Tous les statuts"}),Object.entries(j).map(([s,a])=>e.jsx("option",{value:s,children:a},s))]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Catégorie"}),e.jsxs(u,{value:o,onValueChange:s=>F(s),children:[e.jsx("option",{value:"",children:"Toutes les catégories"}),e.jsx("option",{value:"tech",children:"Tech"}),e.jsx("option",{value:"agri",children:"Agri"}),e.jsx("option",{value:"social",children:"Social"})]})]})]})})]}),e.jsxs(r,{children:[e.jsxs(p,{children:[e.jsx(f,{children:"Liste des candidatures"}),e.jsxs(N,{children:[t.total," candidature",t.total>1?"s":""," trouvée",t.total>1?"s":""]})]}),e.jsx(i,{children:e.jsx("div",{className:"overflow-x-auto w-full",children:e.jsx(L,{columns:k,data:t.data,pagination:{pageIndex:t.current_page-1,pageSize:t.per_page,pageCount:Math.ceil(t.total/t.per_page),total:t.total}})})})]})]})})]})}export{pe as default};
